{% extends 'base.html' %}
{% load static %}
{% block head %}
<link rel="stylesheet" href="{% static 'css/mypage.css' %}">
{% endblock %}

{% block content %}
<div class="mypage_container bg row justify-content-center">
    <div class="mypage_nav col-4 d-none d-md-block">
        <h3 class="mypage_title">마이페이지</h3>
        <!-- border-left 색상 바꾸기 (클릭 모션) -->
        <ul>
            <li><a href="{% url 'mypageProfile' %}">회원정보 수정</a></li>
            <li><a href="{% url 'infoWrite' %}">체크리스트 수정</a></li>
            <li><a href="{% url 'mypageScrap' %}">스크랩 목록</a></li>
            <li><a href="{% url 'mypageWritten' %}">내가 작성한 글</a></li>
        </ul>
    </div>
    <!-- 모바일버전 nav -->
    <div class="mypage_nav_mobile row d-block d-md-none">
        <ul >
            <li><a href="{% url 'mypageProfile' %}">회원정보 수정</a></li>
            <li><a href="{% url 'infoWrite' %}">체크리스트 수정</a></li>
            <li><a href="{% url 'mypageScrap' %}">스크랩 목록</a></li>
            <li><a href="{% url 'mypageWritten' %}">내가 작성한 글</a></li>
        </ul>
    </div>
    <div class="mypage_content col-10 col-md-8">
        <div class="mypage_scap-content">
            <h3 class="mypage_subtitle row">자취 정보 스크랩</h3>
            <form action="">
                <button class="row" formaction="{% url 'mypageScrap' %}">룸메이트 찾기</button>
                <button class="row" formaction="{% url 'mypageScrap_dom' %}" >기숙사 정보</button>
                <button class="row" formaction="{% url 'mypageScrap_off' %}">자취 정보</button>
            </form>

            <div id="off">
                <button class="mypage_btn row">수정</button>

                <div class="mypage_sub-bar row">
                    <div class="col-2">
                        <input class="checkbox_all" type="checkbox" name="written" id="checkbox" value='selectall' onclick='selectAll(this);'>
                    </div>
                    <p class="p-2 col-5" style="margin-top:0;">글쓴이</p>
                    <p class="p-2 col-5" style="margin-top:0;">제목</p>
                </div>
                <form action="" method="POST">
                    {% csrf_token %}
                    <div>
                        {% for scrap in off_scraps %}
                            <input type="checkbox" name="check[]" class="mypage_list-checkbox checkbox_all" value="{{scrap.id}}">
                            <p>{{ scrap.Offcampus_Post.user_id.user_nickname }}</p>
                            <p><a href="{% url 'offcampusView' scrap.Offcampus_Post.id %}">{{ scrap.Offcampus_Post.title }}</a></p>
                        {% endfor %}
                    </div>
        
                    <button type="submit" class="mypage_delete">삭제하기</button>
                </form>
                <div>
                    <ul class="pagination">
                        <li class="page-item"><a class="page-link" href="#">◀</a></li>
                        {% for page in off_page_range %}
                        <li class="page-item"><a class="page-link" href="{% url 'mypageScrap'%}?page={{page}}">{{page}}</a>
                        </li>
                        {% endfor %}
                        <li class="page-item"><a class="page-link" href="#">▶</a></li>
                    </ul>
                </div>
            </div>

        </div>
    </div>
</div>



    <script>
        const mypage_btn = document.querySelector('.mypage_btn');
        const mypage_list_checkbox = document.querySelectorAll('.mypage_list-checkbox');
        const checkbox_all = document.querySelectorAll('.checkbox_all');
        const delete_btn = document.querySelector('.mypage_delete');

        let edit = 0;
        delete_btn.style.visibility = 'hidden';

        for (var i = 0; i < checkbox_all.length; i++) {
            checkbox_all[i].style.visibility = 'hidden';
        }
        mypage_btn.addEventListener('click', function (event) {

            if (edit == 0) {
                edit = 1;
                for (var i = 0; i < checkbox_all.length; i++) {
                    checkbox_all[i].style.visibility = 'visible';
                }
                delete_btn.style.visibility = 'visible';
            }
            else {
                edit = 0;
                for (var i = 0; i < checkbox_all.length; i++) {
                    checkbox_all[i].style.visibility = 'hidden';
                }
                delete_btn.style.visibility = 'hidden';
            }
        });

        //체크박스 전체선택 기능
        function selectAll(selectAll) {
            const checkboxes = document.querySelectorAll('.mypage_list-checkbox');

            checkboxes.forEach((checkbox) => {
                checkbox.checked = selectAll.checked;
                //체크박스의 checked 값을 'Select All' element의 check 값(selectAll.checked)과 동일하게 변경
            })
        }

    </script>



    {% endblock %}